---
title: "R Notebook for Probability Exercises"
output: html_notebook
---

 

```{r}
## 1.8 Probability and counting ========

# Page 29: Vectors
v <- c(1,3,5,7,9,11)
v[c(1,3)]
v[-c(1,3)]
v2 <- 1/(1:100)^2

# Page 30 Factorials  
choose(10,2)
choose(1000000,1000)
lchoose(1000000,1000)
factorial(1000)
lfactorial(1000)

# Page 30-31 Sampling and simulation
n <- 10; k <- 6
sample(n,k, replace =TRUE)
sample(letters,k)
sample(5,5,replace=TRUE,prob = c(0.6,0.1,0.1,0.1,0.1))

# Page 31 Matching problem simulation
n <- 10;        # number of cards
r <- 1       # number of times running experiment
results<- replicate(r,sample(n)==(1:n)) # shuffle and count matches
number.successes<-sum(results>=1) # sum number of matches
proportion.matches = number.successes/(r*n) # proportion of matches to total number of experiments

# Page 32 Birthday problem
qbirthday(0.5)        # number of people needed to have probability of at least 50% of at least one match
pbirthday(23,coincident = 3)  # probability of a triple birthday match given 23 people 
b <- sample (365,23,replace=TRUE)  # assign birthdays to 23 people, where each of 365 "days"" has equal probability
table(b)
r <- replicate(10^4, max(table(sample(365,23,replace=TRUE))))
sum(r>=2)/10^4 # how many days had at least two people born on that day, on average after 10^4 runs?

```

```{r}
## 2.10 Conditional probability ========

# Page 80: Simulating the frequentist interpretation
n <- 10^5       #number of families
child1 <- sample(2,n,replace=TRUE)  # let 1 be a girl, 2 be a boy
child2 <- sample(2,n,replace=TRUE)  

n.b <- sum(child1==1) #number times child 1 is a girl
n.ab <- sum(child1==1 & child2 ==1) # number times both children are girls

p.a.given.b <- n.ab/n.b # prob. both girls given child1 is a girl

n.c <- sum(child1==1 | child2 ==1) #number families either child 1 or 2 (or both) is a girl
p.ab.given.c <- n.ab/n.c # prob. both girls given at least one is a girl

# Page 82 Monty Hall simulation
n <- 10^5 #number of times to run simulation
cardoor <- sample(3,n,replace = TRUE) #assign a location for the car
p.success.choose1 <- sum(cardoor==1)/n #if don't switch, choose 1 door, probability of success (about 1/3)

monty <- function() { #create an interactive function
    doors <- 1:3
    cardoor <- sample(doors,1) #random sample of 1:3
    print("Pick a door (enter 1,2 or 3)") #prompt
    chosen<-scan(what=integer(),nlines = 1,quiet=TRUE) #receive choice of door
    if (chosen!=cardoor) montydoor<-doors[-c(chosen,cardoor)] else montydoor <- sample(doors[-chosen],1) #pick Monty's door
    print(paste("Monty opens door ",montydoor,".", sep = ""))
    print("Would you like to switch (y/n)?") #prompt to switch
    reply<- scan(what=character(),nlines=1,quiet =TRUE)
    
    if(substr(reply,1,1)=="y") {  #only change chosen if "y"
      chosen<-doors[-c(chosen,montydoor)]
    }
    
    if(chosen==cardoor) print("Yatze!") else print("Dang.")
    
}
monty()  

```
 
```{r}
## 3.11  Random variables and their distributions ========

#Page 138 Distributions in R
help(distributions)

#Page 138 Binomial distribution
dbinom(3,5,0.2)  # binomial PDF with inputs (k,n,p)
pbinom(3,4,0.2)  # binomial CDF with inputs (k,n,p)
rbinom(10,4,0.5) # rancom set of x binomial of (x,n,p)

#Page 139 Hypergeometric
dhyper(1,5,5,3) # hypergeometric X=k=1 from ~Hypergeometric(w=5,b=5,n=3)

# Page 139 Discrete distributions with finite support
# Use sample function sample (n,k) where n is the distribution and k is the number of elements to choose...but we can make x a vector of values with a corresponding vector, p, of probabilities (so x can be any distribution!)

#example:
x<-c(0,1,5,10) #values
p <-c(0.25,0.5,0.1,0.15) # PMF of x
sample(x,100,prob=p,replace=TRUE) #sample 100 times from distribution'x' 

```

```{r}
## 4.11 Expectation ========

##Page 193 Matching simulation

n <- 100
r <- replicate(10^4,sum(sample(n)==(1:n))) # looking at chance matches of a random sample of a deck of n cards ...
mean(r) # expected number of matches (the mean)

##Page 193 Distinct birthday simulation
 k <- 20 # group of 20 people
 r <- replicate (10^4, {bdays <- sample(365,k,replace = TRUE);
                        length(unique(bdays))}) #we sample k times from 1:365, then remove duplicates with unique(bdays) and length() calculatates the length AFTER duplicates have been removed... so R contains the # of distinct birhtdays
 
 mean(r) # the empirical value with 10^4 trials
365*(1-(364/365)^k) #the theoretic value
```

